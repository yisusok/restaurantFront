---
import Layout from "../layouts/Layout.astro"
---
<Layout>
  <div class="bg-gray-900 min-h-screen flex justify-center items-center justify-center w-full">
    <div class="bg-gray-800/90 backdrop-blur-md rounded-2xl shadow-2xl p-10 w-full max-w-md">
      <h1 class="text-3xl font-serif text-amber-400 mb-6 text-center">Login Administrador</h1>
      
      <div id="error" class="text-red-500 mb-4 text-center"></div>
      
      <input id="usuario" placeholder="Usuario" 
             class="w-full px-4 py-3 mb-4 rounded-lg border border-gray-700 bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:border-amber-400 transition-colors"/>
      
      <input id="password" placeholder="Contraseña" type="password" 
             class="w-full px-4 py-3 mb-6 rounded-lg border border-gray-700 bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:border-amber-400 transition-colors"/>
      
      <button id="btnLogin"
              class="w-full bg-amber-500 hover:bg-amber-600 text-gray-900 font-medium py-3 rounded-lg shadow-md transition-colors">
        Ingresar
      </button>

      <script type="module">
        const btnLogin = document.getElementById('btnLogin');
        const errorDiv = document.getElementById('error');

        btnLogin.addEventListener('click', async () => {
          const usuario = document.getElementById('usuario').value;
          const password = document.getElementById('password').value;

          const res = await fetch('http://localhost:3000/admin/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ usuario, password })
          });
          const data = await res.json();

          if (data.success) {
            sessionStorage.setItem('adminLogged', 'true');
            window.location.href = '/admin/Crud';
          } else {
            errorDiv.textContent = 'Usuario o contraseña incorrectos';
          }
        });
      </script>
    </div>
  </div>
</Layout>
